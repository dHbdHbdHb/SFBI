"0","fc_bldg_exposure <- readRDS(""fc_bldg_exposure.rds"")"
"0",""
"0","vulnerability_summary_montecarlo <-"
"0","  map2("
"0","    sedan_vulnerability$perc_damage,"
"0","    sedan_vulnerability$std,"
"0","    function(x,y) rnorm(100, x, y)"
"0","  ) %>% "
"0","  transpose()"
"0",""
"0","rcp45 <- read_csv(""https://raw.githubusercontent.com/stanfordfuturebay/stanfordfuturebay.github.io/master/advanced/rcp45_sanfrancisco.csv"")"
"1","[1mRows: [22m[34m10[39m [1mColumns: [22m[34m10[39m
"
"1","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[32mdbl[39m (10): SLR, 2020, 2030, 2040, 2050, 2060, 2070, 2080, 2090, 2100
"
"1","
[36mâ„¹[39m Use [38;5;251m[48;5;235m[38;5;251m[48;5;235m`spec()`[48;5;235m[38;5;251m[49m[39m to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set [38;5;251m[48;5;235m[38;5;251m[48;5;235m`show_col_types = FALSE`[48;5;235m[38;5;251m[49m[39m to quiet this message.
"
"0","montecarlo_result <-"
"0","  vulnerability_summary_montecarlo %>% "
"0","  map(function(damage_amt){"
"0",""
"0","    temp <- approx("
"0","      x = sedan_vulnerability$depth,"
"0","      y = damage_amt %>% unlist(),"
"0","      xout = fc_bldg_exposure$avg_depth"
"0","      ) %>% "
"0","      .[2] %>% "
"0","      as.data.frame() %>% "
"0","      rename(perc_damage = y) %>% "
"0","      cbind(fc_bldg_exposure) %>% "
"0","      left_join(fc_veh_per_bldg) %>% "
"0","      mutate(damage = avg_sedan_cost * perc_damage) %>% "
"0","      dplyr::select(osm_id, SLR, RP, damage) %>% "
"0","      pivot_wider("
"0","          names_from = RP,"
"0","          values_from = damage"
"0","        ) %>% "
"0","      replace(is.na(.), 0) %>% "
"0","      mutate("
"0","          damage = "
"0","            0.95*(`001`+`020`)/2 + "
"0","            0.04*(`020`+`100`)/2 + "
"0","            0.01*(`100`)"
"0","      ) %>% "
"0","      dplyr::select(osm_id, SLR, damage) %>% "
"0","      left_join("
"0","          rcp45 %>% "
"0","            mutate("
"0","              SLR = str_pad(SLR, 3 , ""left"", ""0"")"
"0","            ) %>% "
"0","            select("
"0","              SLR,"
"0","              `2020`,"
"0","              `2030`,"
"0","              `2040`,"
"0","              `2050`"
"0","            )"
"0","        ) %>% "
"0","        pivot_longer("
"0","          `2020`:`2050`,"
"0","          names_to = ""year"","
"0","          values_to = ""occurrence"""
"0","        ) %>% "
"0","        pivot_longer("
"0","          c(damage,occurrence),"
"0","          names_to = ""key"","
"0","          values_to = ""value"""
"0","        ) %>% "
"0","        pivot_wider("
"0","          names_from = c(""key"",""SLR""),"
"0","          values_from = value"
"0","        ) %>% "
"0","        replace(is.na(.), 0) %>% "
"0","        mutate("
"0","          damage = "
"0","            occurrence_000 * (damage_000 + damage_025)/2 + "
"0","            occurrence_025 * (damage_025 + damage_050)/2 + "
"0","            occurrence_050 * (damage_050),"
"0","          year = as.numeric(year)"
"0","        ) %>% "
"0","        left_join(fc_veh_per_bldg) %>%"
"0","        left_join(emfac, by = c(""year"" = ""Calendar Year"")) %>% "
"0","        mutate(annual_damage = damage*veh_per_bldg*perc_moved*perc_safe*perc_change) %>%"
"0","        dplyr::select(osm_id, year, damage) %>% "
"0","      pivot_wider("
"0","        names_from = year,"
"0","        values_from = damage"
"0","      ) %>% "
"0","      mutate( "
"0","        aal = (`2020`*5 + `2030`*10 + `2040`*10 + `2050`*5)/30"
"0","      ) %>% "
"0","      pull(aal) %>% "
"0","      sum()"
"0","  "
"0","      }) %>% "
"0","      unlist()"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"2","Warning: stack imbalance in '[[', 141 then 140
"
"2","Warning: stack imbalance in 'vapply', 128 then 125
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"2","*** recursive gc invocation
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""osm_id""
"
"1","Joining, by = ""SLR""
"
"1","Joining, by = ""osm_id""
"
