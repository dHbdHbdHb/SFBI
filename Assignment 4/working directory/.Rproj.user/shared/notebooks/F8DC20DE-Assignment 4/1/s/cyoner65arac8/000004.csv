"0","fc_bldg_exposure <- NULL"
"0",""
"0",""
"0","for(slr in c(""000"",""025"",""050"")){"
"0","  "
"0","  for(rp in c(""001"",""020"",""100"")){"
"0","    "
"0","    print(paste0(""SLR"",slr,""_RP"",rp))"
"0","    "
"0","    fc_flood <- raster( paste0(""SLR/flood"",slr,""_RP"",rp,""_fc_flood.tif""))"
"0","    fc_flood[is.na(fc_flood)] <- 0"
"0","    # fc_flood <- rasters[[9]]"
"0","    # raster( paste0(""SLR/flood"",slr,""_RP"",rp,""_fc_flood.tif""))"
"0","    "
"0","    fc_flood_extent <- "
"0","      (fc_flood > -Inf) %>% "
"0","      st_as_stars() %>% "
"0","      st_as_sf(merge = T) %>% "
"0","      st_set_crs(26910) %>% "
"0","      st_make_valid() %>% "
"0","      st_transform(4326)"
"0","    "
"0","    fc_bldg_flooded <-"
"0","      fc_bldg_flooded_max[fc_flood_extent,] %>% ##if na populate with a zero"
"0","      st_transform(26910)"
"0",""
"0","    "
"0","    if (nrow(fc_bldg_flooded) == 0) { # skip extract if no buildings touched"
"0","      fc_temp <- data.frame("
"0","        avg_depth = numeric(),"
"0","        osm_id = character(),"
"0","        SLR = character(),"
"0","        RP = character() "
"0","      )"
"0","    } else {"
"0","      fc_flood_crop <-"
"0","       crop(fc_flood, fc_bldg_flooded)  #if there's nothing to crop to, set all 0"
"0","      "
"0","      fc_temp <-"
"0","        raster::extract("
"0","          fc_flood_crop,"
"0","          fc_bldg_flooded,"
"0","          fun = mean"
"0","        ) %>%"
"0","        as.data.frame() %>% "
"0","        rename(avg_depth = V1) %>% "
"0","        cbind("
"0","          fc_bldg_flooded %>% "
"0","            st_drop_geometry() %>% "
"0","            dplyr::select(osm_id)"
"0","        ) %>% "
"0","        mutate("
"0","          SLR = slr,"
"0","          RP = rp"
"0","        )"
"0","    }"
"0","    fc_bldg_exposure <- "
"0","      fc_bldg_exposure %>% "
"0","      rbind(fc_temp)"
"0","    saveRDS(fc_bldg_exposure,""fc_bldg_exposure.rds"")"
"0","    # saveRDS(fc_bldg_exposure,""fc_bldg_exposure.rds"")"
"0","  }"
"0","}"
"1","[1]"
"1"," ""SLR000_RP001"""
"1","
"
"1","[1]"
"1"," ""SLR000_RP020"""
"1","
"
"1","[1]"
"1"," ""SLR000_RP100"""
"1","
"
"1","[1]"
"1"," ""SLR025_RP001"""
"1","
"
"1","[1]"
"1"," ""SLR025_RP020"""
"1","
"
"1","[1]"
"1"," ""SLR025_RP100"""
"1","
"
"1","[1]"
"1"," ""SLR050_RP001"""
"1","
"
"1","[1]"
"1"," ""SLR050_RP020"""
"1","
"
"1","[1]"
"1"," ""SLR050_RP100"""
"1","
"
"0","saveRDS(fc_bldg_exposure,""fc_bldg_exposure.rds"")"
